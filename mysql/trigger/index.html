<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Creating Trigger # mysql> CREATE TRIGGER ins_sum BEFORE INSERT ON account FOR EACH ROW SET @sum = @sum + NEW.amount; Show Trigger # mysql> SHOW TRIGGERS; Dropping Trigger # mysql> DROP TRIGGER IF EXISTS test.ins_sum; OLD and NEW Extensions # Within the trigger body, the OLD and NEW keywords enable you to access columns in the rows affected by a trigger. OLD and NEW are MySQL extensions to triggers; they are not case-sensitive."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Trigger"><meta property="og:description" content="Creating Trigger # mysql> CREATE TRIGGER ins_sum BEFORE INSERT ON account FOR EACH ROW SET @sum = @sum + NEW.amount; Show Trigger # mysql> SHOW TRIGGERS; Dropping Trigger # mysql> DROP TRIGGER IF EXISTS test.ins_sum; OLD and NEW Extensions # Within the trigger body, the OLD and NEW keywords enable you to access columns in the rows affected by a trigger. OLD and NEW are MySQL extensions to triggers; they are not case-sensitive."><meta property="og:type" content="article"><meta property="og:url" content="http://example.org/mysql/trigger/"><meta property="article:section" content="mysql"><meta property="article:published_time" content="2023-02-22T15:03:28+08:00"><meta property="article:modified_time" content="2023-02-22T15:03:28+08:00"><title>Trigger | Handbook</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.a82d7e77ceb134d151c4d7e381eeb30623fbd5a524d58c584d8716ecec0205bd.css integrity="sha256-qC1+d86xNNFRxNfjge6zBiP71aUk1YxYTYcW7OwCBb0=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.78166b9d46e23e0ea915cb6887a30b633e7bc4fad10c8b6b9f6fa532271c19ba.js integrity="sha256-eBZrnUbiPg6pFctoh6MLYz57xPrRDItrn2+lMiccGbo=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Handbook</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><span>Redis</span><ul><li><a href=/redis/common-commands/>Common Commands</a></li><li><a href=/redis/transactions/>Transations</a></li></ul></li><li><span>SQL</span><ul><li><a href=/sql/common-expressions/>Common Expressions</a></li><li><a href=/sql/common-functions/>Common Functions</a></li><li><a href=/sql/views/>Views</a></li></ul></li><li><span>MySQL</span><ul><li><a href=/mysql/stored-procedures/>Stored Procedures</a></li><li><a href=/mysql/transactions/>Transactions</a></li><li><a href=/mysql/trigger/ class=active>Trigger</a></li></ul></li><li><span>PowerShell</span><ul><li><a href=/powershell/file/>File</a></li></ul></li><li><span>Docker</span><ul><li><a href=/docker/common-commands/>Common Commands</a></li></ul></li><li><span>Git</span><ul><li><a href=/git/common-commands/>Common Commands</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Trigger</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#creating-trigger>Creating Trigger</a></li><li><a href=#show-trigger>Show Trigger</a></li><li><a href=#dropping-trigger>Dropping Trigger</a></li><li><a href=#old-and-new-extensions>OLD and NEW Extensions</a></li><li><a href=#attention>Attention</a></li><li><a href=#reference>Reference</a></li></ul></li></ul></nav></aside></header><article class=markdown><h3 id=creating-trigger>Creating Trigger
<a class=anchor href=#creating-trigger>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mysql&gt; CREATE TRIGGER ins_sum 
</span></span><span style=display:flex><span>       BEFORE INSERT
</span></span><span style=display:flex><span>       ON account
</span></span><span style=display:flex><span>       FOR EACH ROW
</span></span><span style=display:flex><span>       SET @sum <span style=color:#f92672>=</span> @sum + NEW.amount;
</span></span></code></pre></div><h3 id=show-trigger>Show Trigger
<a class=anchor href=#show-trigger>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mysql&gt; SHOW TRIGGERS;
</span></span></code></pre></div><h3 id=dropping-trigger>Dropping Trigger
<a class=anchor href=#dropping-trigger>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mysql&gt; DROP TRIGGER IF EXISTS test.ins_sum;
</span></span></code></pre></div><h3 id=old-and-new-extensions>OLD and NEW Extensions
<a class=anchor href=#old-and-new-extensions>#</a></h3><p>Within the trigger body, the <code>OLD</code> and <code>NEW</code> keywords enable you to access columns in the rows affected by a trigger. <code>OLD</code> and <code>NEW</code> are MySQL extensions to triggers; they are not case-sensitive.</p><blockquote class="book-hint warning">In a <code>BEFORE</code> trigger, the <code>NEW</code> value for an <code>AUTO_INCREMENT</code> column is <code>0</code>, not the sequence number that is generated automatically when the new row <strong>actually</strong> is inserted.</blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mysql&gt; delimiter //
</span></span><span style=display:flex><span>mysql&gt; CREATE TRIGGER upd_check BEFORE UPDATE ON account
</span></span><span style=display:flex><span>       FOR EACH ROW
</span></span><span style=display:flex><span>       BEGIN
</span></span><span style=display:flex><span>           IF NEW.amount &lt; <span style=color:#ae81ff>0</span> THEN
</span></span><span style=display:flex><span>               SET NEW.amount <span style=color:#f92672>=</span> 0;
</span></span><span style=display:flex><span>           ELSEIF NEW.amount &gt; <span style=color:#ae81ff>100</span> THEN
</span></span><span style=display:flex><span>               SET NEW.amount <span style=color:#f92672>=</span> 100;
</span></span><span style=display:flex><span>           END IF;
</span></span><span style=display:flex><span>       END;//
</span></span><span style=display:flex><span>mysql&gt; delimiter ;
</span></span></code></pre></div><h3 id=attention>Attention
<a class=anchor href=#attention>#</a></h3><blockquote class="book-hint danger">In the trigger, we can modify the data in any tables except the table that this trigger is for. Otherwise it will end in an infinite loop, because this trigger will fire itself.</blockquote><h3 id=reference>Reference
<a class=anchor href=#reference>#</a></h3><ul><li><a href=https://dev.mysql.com/doc/refman/8.0/en/trigger-syntax.html>MySQL Reference Manual</a>.</li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#creating-trigger>Creating Trigger</a></li><li><a href=#show-trigger>Show Trigger</a></li><li><a href=#dropping-trigger>Dropping Trigger</a></li><li><a href=#old-and-new-extensions>OLD and NEW Extensions</a></li><li><a href=#attention>Attention</a></li><li><a href=#reference>Reference</a></li></ul></li></ul></nav></div></aside></main></body></html>